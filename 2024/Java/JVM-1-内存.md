# JVM
什么是JVM？
> 一种规范
> JVM支持多语音，不同平台有不同JVM实现，符合JVM规范即可
1、JDK、JRE、JVM是什么？
1. JDK：JRE+工具
2. JRE：Java运行环境，包含JVM+java类库
3. JVM：包含ClassLoader、JIT即时编译器、字节码解释器、执行引擎
2、JVM是如何实现的？
1. C++实现的
2. 内部有C++实现的解释器，将Java语言转换为C++语言中的实现（字节码解释，经过一次翻译，性能慢一些）
3、JVM和JIT的关系
1. 热点代码(根据执行次数判断)会通过JIT编译成汇编，汇编会有对应的机器码(10101010101的机器码)
2. 次数怎么确定？后端，一万次。
3. JVM会分为server端和client端
4、JIT的缺点？
1. 需要提前处理
2. 可以将翻译后的汇编代码存放到codecache中
5、运行时数据区是什么？
> 1. JVM在执行Java程序时，将内存划分为若干区域。用于执行程序。这块内存就是`运行时数据区`
> 2. 此外，在运行时数据区之外，还有一块是`直接内存`

## 运行时数据区
1、运行时数据区的组成部分
1. 线程共享：方法区（运行时常量池）、堆
2. 线程私有：每个线程都有，本地方法栈、虚拟机栈、PC
3. 栈中的基本单元是栈帧
2、永久代、元空间是什么？
> HotSpot中概念，JVM规范中没有
> 用永久代、元空间实现了JVM规范中的方法区
3、堆外内存/直接内存是什么？
1. 直接内存，没有经过JVM的虚拟化
2. 需要分配内存、释放
4、虚拟化是什么？运行时数据区经过了JVM的虚拟化
> 实现虚拟化，不需要直接在内存上去找对象
> 用new的方式，将对象存储到堆上，用引用找到堆上对象，就可以使用了
### 栈帧
1、栈帧的组成部分
1. 局部变量表
2. 操作数栈
3. 动态链接：是什么？
4. 方法返回/完成出口：上一个方法的PC值
2、程序计数器/PC是什么？
> 指示器，值是字节码指令的地址，是当前正在执行的
#### Java方法的运行和虚拟机栈
启动一个线程就会创建虚拟机栈
1. main方法会创建栈帧，入栈
2. 后续每个方法，执行时，都会创建栈帧，并且入栈
3. 方法执行完会出栈
2、虚拟机栈有大小限制 -Xss
> 默认值是1024KB
> 可以设置：-Xss1m、-Xss1024K、-Xss1048576 默认是Byte
3、StackoverFlow是什么？
> 栈溢出，死递归，爆掉了
4、虚拟机栈太多了，内存吃紧，会撑爆内存

